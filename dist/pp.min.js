(function(){var e,t,n,r,i={}.hasOwnProperty,s=[].slice;r=this,n={},t=r.pp,typeof module=="object"?module.exports=n:r.pp=n,n.noConflict=function(){return r.pp=t,n},e={},n.extend=function(t){var n,r,s,o;o=typeof t=="function"?t(e):t;for(r in o){if(!i.call(o,r))continue;s=o[r],n=r.match(/^_/i),n?e[r.substring(1)]=s:this[r]=s}return this},n.extend(function(e){var t,n,r,o;return n=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":return!0;default:return e===null}},t=Array.isArray||function(e){return toString.call(e)==="[object Array]"},r=function(){var e,t;t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],process.nextTick(function(){t.apply(null,e)})},o=function(){var e,t,n;t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],n=setTimeout(function(){clearTimeout(n),t.apply(null,e)},0)},{_isPrimitive:n,_isArray:t,_keys:Object.keys||function(e){var t,n;n=[];for(t in e){if(!i.call(e,t))continue;n.push(t)}return n},_inherit:Object.create||function(e){var r,i;return i=e,n(e)?i:t(e)?[]:toString.call(e)==="[object Object]"?{}:(r=function(){},r.prototype=e.prototype,new r)},_slice:[].slice,_nothing:function(){},_id:function(e){return e},_not:function(e){return!e},defer:process&&typeof process.nextTick=="function"?r:o,_invalidArgumentError:function(e,t,n){return new TypeError(""+e+" - Invalid Argument : "+t+"\n"+n)}}}),n.extend(function(e){var t,r,i,o,u,a;return t=function(){var e,t,n,r,i;t={},i=[240,120,75,60,45,30,27,15,1];for(n=0,r=i.length;n<r;n++)e=i[n],t["FPS_"+e]=~~(1e3/e);return t}(),r=Date.now||function(){return+(new Date)},u=[],a=[],i=function(){var e,t,s;if(!u.length)return;e=u.shift(),s=a.shift(),t=r()+s;while(typeof e=="function"&&r()<t)e=e();typeof e=="function"&&(u.push(e),a.push(s)),n.defer(i)},o=function(e){return typeof e!="number"?t.FPS_240:Math.max(e,t.FPS_240)},{TIME_SLICE:t,trampoline:function(e){var t,r;return r=e.length,t=function(){var f,l;l=1<=arguments.length?s.call(arguments,0):[];if(r<=l.length){u.push(e.apply(null,l.slice(0,r))),a.push(o(r<l.length?l[r]:null)),u.length===1&&n.defer(i);return}return f=function(){var e;return e=1<=arguments.length?s.call(arguments,0):[],e.length<1?f:t.apply(null,l.concat(e))}}}}}),n.extend(function(e){return{_trampolines:function(e){var t,r,s;s={};for(t in e){if(!i.call(e,t))continue;r=e[t],t.match(/^_/i)?s[t]=r:(s["_"+t]=r,s[t]=n.trampoline(r))}return s},_iteratorMixin:function(t,n,r){var i;return i=function(i,s,o){var u;if(e.isPrimitive(o)){u="required Array or Object as HashMap",s(e.invalidArgumentError(t,o,u));return}return e.isArray(o)?n(i,s,o):r(i,s,o)}}}}),n.extend(function(e){var t,r,i,s,o;return s="unresolved",i="resolved",r="rejected",o=n.trampoline(function(e,t){var n;return e.result=t,n=function(){var t,s;if(e.stack.length<1){e.state!==r&&(e.state=i);return}t=e.stack.shift(),s=e.state===r?t[1]:t[0];if(s)try{e.result=s.call(e.scope,e.result)}catch(o){e.state=r,e.result=o}return n}}),t=function(){function e(e){this.state=s,this.stack=[],this.scope=e||null}return e.prototype.STATE={UNRESOULVED:s,RESOLVED:i,REJECTED:r},e.prototype.resolve=function(e){return o(this,e),this},e.prototype.reject=function(e){return this.state=r,o(this,e),this},e.prototype.isResolved=function(){return this.state===i},e.prototype.isRejected=function(){return this.state===r},e.prototype.then=function(e,t,n){return this.stack.push([e||null,t||null,n||null]),this.state!==s&&o(this,null),this},e}(),{promise:function(e){return new t(e)}}}),n.extend(function(e){var t;return t=function(){function t(e){this.continuation=e}return t.prototype.next=function(t){return typeof t!="function"&&(t=e.id),this.continuation(function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],this.continuation=n,r=t.apply(null,e)||(e.length===1?e[0]:e),r})},t}(),{generator:function(e){return new t(e)}}}),n.extend(function(e){var t,n;return n=function(t){var n;return n=function(n,r,i){var s,o,u,a,f,l;return i.length?(u=s=0,o=l=!1,f=function(t){if(o)return;if(t||1<arguments.length||++s>=i.length)l=e.slice.call(arguments),l[0]=t||null},a=function(){if(o)return;return t(u,i.length,s)&&(n(f,i[u],u,i),++u),l&&(o=!0,r.apply(null,l)),a}):r(null)}},t={fill:n(function(e,t){return e<t}),order:n(function(e,t,n){return e===n&&e<t}),array:function(e){return this[e]},hash:function(n){var r;return r=function(r,i,s){var o;return o=function(e,t){r(e,s[t],t,s)},t[n](o,i,e.keys(s))}},mixin:function(t,n){return e.iteratorMixin(t,this.array(n),this.hash(n))}},e.trampolines({_forEach:t,each:t.mixin("pp#each","fill"),eachOrder:t.mixin("pp#eachOrder","order")})}),n.extend(function(e){var t;return t={arrayMap:function(e){var t;return t=function(t,n,r){var i,s,o;return o=[],s=function(e,n,r,i){var s;s=function(t,n){o[r]=n,e(t)},t(s,n,r,i)},i=function(e){n(e,o)},e(s,i,r)}},hashMap:function(t){var n;return n=function(n,r,i){var s,o,u;return u={},o=function(e,t,r,s){var o;o=function(n,r){u[t]=r,e(n)},n(o,i[t],t,i)},s=function(e){r(e,u)},t(o,s,e.keys(i))}},mixin:function(t,n){var r;return r=e.forEach[n],e.iteratorMixin(t,this.arrayMap(r),this.hashMap(r))}},e.trampolines({map:t.mixin("pp#map","fill"),mapOrder:t.mixin("pp#mapOrder","order")})}),n.extend(function(e){var t,n,r,i;return t={left:{name:"pp#foldl",selectIndex:e.id,getInit:"shift"},right:{name:"pp#foldr",selectIndex:function(e,t){return t-(e+1)},getInit:"pop"}},i=function(t,n){var r;if(!e.isArray(n))r="require Array (Not Null) to folding, but "+typeof n;else{if(!!n.length)return;r="Array length is 0, and without init value"}return e.invalidArgumentError(t,n,r)},r=function(t){var n,r,s,o;return o=t.selectIndex,r=function(t,n,r,i){var s,u,a;return a=r,u=function(e,n,r,i){var s;r=o(r,i.length),s=function(t,n){a=n,e(t)},t(s,a,i[r],r,i)},s=function(e){n(e,a)},e.forEach.order(u,s,i)},s=t.getInit,n=t.name+"1",{withInit:r,withoutInit:function(e,t,o){var u,a,f;return a=i(n,o),a?t(a):(u=o.slice(),f=u[s](),r(e,t,f,u))}}},n={left:r(t.left),right:r(t.right)},e.trampolines({foldl:n.left.withInit,foldr:n.right.withInit,foldl1:n.left.withoutInit,foldr1:n.right.withoutInit})}),n.extend(function(e){var t;return t={array:function(t){var n;return n=function(n,r,i){var s,o,u;return u=[],o=function(e,r,s){var o;return o=function(n,i){t(i)&&u.push(r),e(n)},n(o,r,s,i)},s=function(e){r(e,u)},e.forEach.order(o,s,i)}},hash:function(t){var n;return n=function(n,r,i){var s,o,u;return u={},o=function(e,r,s,o){var a;a=function(n,s){t(s)&&(u[r]=i[r]),e(n)},n(a,i[r],r,i)},s=function(e){r(e,u)},e.forEach.order(o,s,e.keys(i))}},mixin:function(t,n){return e.iteratorMixin(t,this.array(n),this.hash(n))}},e.trampolines({filter:t.mixin("pp#filter",e.id),reject:t.mixin("pp#reject",e.not)})}),n.extend(function(e){return e.trampolines({any:function(t,n,r){var i,s;return s=function(e,n,r,i){var s;s=function(t,n){n?e(t,n,r):e(t)},t(s,n,r,i)},i=function(e,t,r){arguments.length<2?n(e,!1):n(e,t,r)},e.each(s,i,r)},all:function(t,n,r){var i,s;return s=function(e,n,r,i){var s;s=function(t,n){n?e(t):e(t,n,r)},t(s,n,r,i)},i=function(e,t,r){arguments.length<2?n(e,!0):n(e,!1,r)},e.each(s,i,r)},find:function(t,n,r){var i,s;return s=function(e,n,r,i){var s;s=function(t,i){i?e(t,n,r):e(t)},t(s,n,r,i)},i=function(e,t,r){arguments.length<2?n(e):n(e,t,r)},e.each(s,i,r)}})}),n.extend(function(e){var t;return t=function(t){var n;return n=function(n,r,i,s){var o,u,a,f,l,c;return l=e.isArray(s)?s.slice():[],u=!1,c=function(t){if(u)return;if(t){u=!0,i(t);return}arguments.length>1&&(l=e.slice.call(arguments,1))},o=function(e,n){if(e||t(n)){u=!0,l.unshift(e||null),i.apply(null,l);return}l.unshift(c),r.apply(null,l)},f=[o],a=function(){if(u)return;return n.apply(null,f.concat(l)),a}}},e.trampolines({whilist:t(e.not),until:t(e.id)})}),n.extend(function(e){var t;return t=function(t,n){var r;return r=function(r,i){var o;return o=function(n,r){var i;if(typeof r!="function"){i="required function. but include "+typeof r,n(e.invalidArgumentError(t,r,i));return}r(function(){var e;e=1<=arguments.length?s.call(arguments,0):[],n.apply(null,e)})},n(o,i,r)}},e.trampolines({fill:t("pp#fill",e.map),order:t("pp#order",e.mapOrder)})}),n.extend(function(e){return{iterator:function(e){var t,n,r;if(!(n=e.length))return;return t=[],r=function(i){var o;return i<t.length?t[i]:(o=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],e[i].apply(e[i],t),o.next()},o.next=function(){return i<n-1?r(i+1):null},o.clearCache=function(){t=[]},t[i]=o,o)},r(0)},waterfall:function(e,t){var r,i;if(!e.length)return t();r=!1,i=function(e){var o,u;return o=function(){var n;n=1<=arguments.length?s.call(arguments,0):[],t.apply(null,n),e.clearCache()},u=function(){var u,a;a=arguments[0],u=2<=arguments.length?s.call(arguments,1):[];if(r)return;if(a){r=!0,t(a);return}n.defer(function(){var t;t=e.next(),u.unshift(t?i(t):o),e.apply(e,u)})}},n.defer(i(n.iterator(e)))}}})}).call(this);