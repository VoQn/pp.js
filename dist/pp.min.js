(function(){var e,t,n,r,i={}.hasOwnProperty,s=[].slice;r=this,n={},t=r.pp,typeof module=="object"?module.exports=n:r.pp=n,n.noConflict=function(){return r.pp=t,n},e={},n.extend=function(t){var n,r,s,o;o=typeof t=="function"?t(e):t;for(r in o){if(!i.call(o,r))continue;s=o[r],n=r.match(/^_/i),e[n?r.substring(1):r]=s,n||(this[r]=s)}return this},n.extend(function(e){var t,n,r,o;return n=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":return!0;default:return e===null}},t=Array.isArray||function(e){return toString.call(e)==="[object Array]"},r=function(){var e,t;t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],process.nextTick(function(){t.apply(null,e)})},o=function(){var e,t,n;t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],n=setTimeout(function(){clearTimeout(n),t.apply(null,e)},0)},{_isPrimitive:n,_isArray:t,_keys:Object.keys||function(e){var t,n;n=[];for(t in e){if(!i.call(e,t))continue;n.push(t)}return n},_inherit:Object.create||function(e){var r,i;return i=e,n(e)?i:t(e)?e.slice():toString.call(e)==="[object Object]"?{}:(r=function(){},r.prototype=e.prototype,new r)},_nothing:function(){},_id:function(e){return e},_not:function(e){return!e},defer:process&&typeof process.nextTick=="function"?r:o,_invalidArgumentError:function(e,t,n){return new TypeError(""+e+" - Invalid Argument : "+t+"\n"+n)}}}),n.extend(function(e){var t,r,i,o,u,a;return t=function(){var e,t,n,r,i;t={},i=[240,120,75,60,45,30,27,15,1];for(n=0,r=i.length;n<r;n++)e=i[n],t["FPS_"+e]=~~(1e3/e);return t}(),u=[],a=[],r=Date.now||function(){return+(new Date)},i=function(){var e,t,s;if(!u.length)return;e=u.shift(),s=a.shift(),t=r()+s;while(typeof e=="function"&&r()<t)e=e();typeof e=="function"&&(u.push(e),a.push(s)),n.defer(i)},o=function(e){return typeof e!="number"?t.FPS_240:Math.max(e,t.FPS_240)},{TIME_SLICE:t,trampoline:function(e){var t,r;return r=e.length,t=function(){var f,l;l=1<=arguments.length?s.call(arguments,0):[];if(r<=l.length){u.push(function(){return e.apply(null,l.slice(0,r))}),a.push(o(r<l.length?l[r]:0)),u.length===1&&n.defer(i);return}return f=function(){var e;return e=1<=arguments.length?s.call(arguments,0):[],e.length<1?f:t.apply(null,l.concat(e))}}}}}),n.extend(function(e){return{_trampolines:function(t){var n,r,s;s={};for(n in t){if(!i.call(t,n))continue;r=t[n],n.match(/^_/i)?s[n]=r:(s["_"+n]=r,s[n]=e.trampoline(r))}return s},_iteratorMixin:function(t,n,r){var i;return i=function(i,s,o){var u;if(e.isPrimitive(o)){u="required Array or Object as HashMap",s(e.invalidArgumentError(t,o,u));return}return e.isArray(o)?n(i,s,o):r(i,s,o)}}}}),n.extend(function(e){var t,r,i,s,o;return s="unresolved",i="resolved",r="rejected",o=n.trampoline(function(e,t){var n;return e.result=t,n=function(){var t,s;if(e.stack.length<1){e.state!==r&&(e.state=i);return}t=e.stack.shift(),s=e.state===r?t[1]:t[0];if(s)try{e.result=s.call(e.scope,e.result)}catch(o){e.state=r,e.result=o}return n}}),t=function(){function e(e){this.state=s,this.stack=[],this.scope=e||null}return e.prototype.STATE={UNRESOULVED:s,RESOLVED:i,REJECTED:r},e.prototype.resolve=function(e){return o(this,e),this},e.prototype.reject=function(e){return this.state=r,o(this,e),this},e.prototype.isResolved=function(){return this.state===i},e.prototype.isRejected=function(){return this.state===r},e.prototype.then=function(e,t,n){return this.stack.push([e||null,t||null,n||null]),this.state!==s&&o(this,null),this},e}(),{promise:function(e){return new t(e)}}}),n.extend(function(e){var t;return t=function(){function t(e){this.continuation=e}return t.prototype.next=function(t){return typeof t!="function"&&(t=e.id),this.continuation(function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],this.continuation=n,r=t.apply(null,e)||(e.length===1?e[0]:e),r})},t}(),{generator:function(e){return new t(e)}}}),n.extend(function(e){var t,n,r,i;return n=function(t,n){var r,i,o=this;return r=function(e,t,r){var i,o,u,a,f,l;return a=r.length,a?(u=i=0,o=!1,l=function(){var e,n;n=arguments[0],e=2<=arguments.length?s.call(arguments,1):[],++i;if(o)return;if(i>=a||n||e.length)o=!0,e.unshift(n||null),t.apply(null,e)},f=function(){if(o)return;return n(u,a,i)&&(e(l,r[u],u,r),++u),f}):t(null)},i=function(t,n,i){var s;return s=function(e,n,r,s){t(e,i[n],n,i)},r(s,n,e.keys(i))},{array:r,hash:i,mixin:e.iteratorMixin(t,r,i)}},r=function(e,t){return e<t},i=function(e,t,n){return e<t&&e<=n},t={fill:n("pp#each",r),order:n("pp#eachOrder",i)},e.trampolines({_arrayEachFill:t.fill.array,_arrayEachOrder:t.order.array,each:t.fill.mixin,eachOrder:t.order.mixin})}),n.extend(function(e){var t,n,r,i,s;return t=function(e){var t;return t=function(t,n,r){var i,s,o,u;return o=[],u=null,s=function(e,n,r,i){u=function(t,n){o[r]=n,e(t)},t(u,n,r,i)},i=function(e){n(e,o)},e(s,i,r)}},r=function(t){var n;return n=function(n,r,i){var s,o,u,a;return u=e.inherit(i),a=null,o=function(e,t,r,s){a=function(n,r){n||(u[t]=r),e(n)},n(a,i[t],t,i)},s=function(e){r(e,u)},t(o,s,e.keys(i))}},i=e.iteratorMixin,n=e.arrayEachFill,s=e.arrayEachOrder,e.trampolines({map:i("pp#map",t(n),r(n)),mapOrder:i("pp#mapOrder",t(s),r(s))})}),n.extend(function(e){var t,n,r,i;return t={left:{name:"pp#foldl",indexChoose:e.id,arrayMethod:"shift"},right:{name:"pp#foldr",indexChoose:function(e,t){return t-(e+1)},arrayMethod:"pop"}},i=function(t,n){var r;if(!e.isArray(n))r="require Array (Not Null) to folding, but "+typeof n;else{if(!!n.length)return;r="Array length is 0, and without init value"}return e.invalidArgumentError(t,n,r)},r=function(t){var n,r;return r=function(n,r,i,s){var o,u,a,f;return f=i,o=null,a=function(e,r,i,s){i=t.indexChoose(i,s.length),o=function(t,n){f=n,e(t)},n(o,f,s[i],i,s)},u=function(e){r(e,f)},e.arrayEachOrder(a,u,s)},n=t.name+"1",{withInit:r,withoutInit:function(e,s,o){var u,a,f;return a=i(n,o),a?s(a):(u=o.slice(),f=u[t.arrayMethod](),r(e,s,f,u))}}},n={left:r(t.left),right:r(t.right)},e.trampolines({foldl:n.left.withInit,foldr:n.right.withInit,foldl1:n.left.withoutInit,foldr1:n.right.withoutInit})}),n.extend(function(e){var t;return t=function(t,n){var r,i;return r=function(t,r,i){var s,o,u,a;return a=[],u=null,o=function(e,r,s){u=function(t,i){n(i)&&a.push(r),e(t)},t(u,r,s,i)},s=function(e){r(e,a)},e.arrayEachOrder(o,s,i)},i=function(t,r,i){var s,o,u,a;return u=e.inherit(i),a=null,o=function(e,r,s,o){a=function(t,s){n(s)&&(u[r]=i[r]),e(t)},t(a,i[r],r,i)},s=function(e){r(e,u)},e.arrayEachFill(o,s,e.keys(i))},e.iteratorMixin(t,r,i)},e.trampolines({filter:t("pp#filter",e.id),reject:t("pp#reject",e.not)})}),n.extend(function(e){var t,n,r,i;return i=function(t,n,r){var i,s;return i=function(t,i,s){var o,u;return o=null,u=function(e,r,i,s){o=function(t,s){if(n(s)){e(t,r,i);return}e(t)},t(o,r,i,s)},e.arrayEachFill(u,r(i),s)},s=function(t,i,s){var o,u;return o=null,u=function(e,r,i,u){o=function(t,i){if(n(i)){e(t,s[r],r);return}e(t)},t(o,s[r],r,s)},e.arrayEachFill(u,r(i),e.keys(s))},e.iteratorMixin(t,i,s)},r=function(e){var t;return t=function(t){var n;return n=function(n){t(n,e(arguments.length))}}},t=function(e){return e>1},n=function(e){return e<2},e.trampolines({any:i("pp#any",e.id,r(t)),all:i("pp#all",e.not,r(n)),find:i("pp#find",e.id,e.id)})}),n.extend(function(e){var t;return t=function(t){var n;return n=function(n,r,i,o){var u,a,f,l,c,h;return c=e.isArray(o)?o.slice():[],a=!1,h=function(){var e,t;t=arguments[0],e=2<=arguments.length?s.call(arguments,1):[];if(a)return;if(t){a=!0,i(t);return}e.length&&(c=e)},u=function(e,n){if(e||t(n)){a=!0,c.unshift(e||null),i.apply(null,c);return}c.unshift(h),r.apply(null,c)},l=[u],f=function(){if(a)return;return n.apply(null,l.concat(c)),f}}},e.trampolines({whilist:t(e.not),until:t(e.id)})}),n.extend(function(e){var t;return t=function(t,n){var r;return r=function(r,i){var o;return o=function(n,r){var i;if(typeof r!="function"){i="required function. but include "+typeof r,n(e.invalidArgumentError(t,r,i));return}r(function(){var e;e=1<=arguments.length?s.call(arguments,0):[],n.apply(null,e)})},n(o,i,r)}},e.trampolines({fill:t("pp#fill",e.map),order:t("pp#order",e.mapOrder)})}),n.extend(function(e){return{iterator:function(e){var t,n,r;if(!(n=e.length))return;return t=[],r=function(i){var o;return i<t.length?t[i]:(o=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],e[i].apply(e[i],t),o.next()},o.next=function(){return i<n-1?r(i+1):null},o.clearCache=function(){t=[]},t[i]=o,o)},r(0)},waterfall:function(e,t){var r,i;if(!e.length)return t();r=!1,i=function(e){var o,u;return o=function(){var n;n=1<=arguments.length?s.call(arguments,0):[],t.apply(null,n),e.clearCache()},u=function(){var u,a;a=arguments[0],u=2<=arguments.length?s.call(arguments,1):[];if(r)return;if(a){r=!0,t(a);return}n.defer(function(){var t;t=e.next(),u.unshift(t?i(t):o),e.apply(e,u)})}},n.defer(i(n.iterator(e)))}}})}).call(this);